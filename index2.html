<!DOCTYPE html>
<html>
  <head>
    <title>Image Display</title>
    <style>
      #apiImage {
        width: 500px; /* desired width */
        height: auto; /* maintain aspect ratio */
      }
    </style>
  </head>
  <body>
    <h1>Image from API</h1>
    <img id="apiImage" src="" alt="Image will be displayed here" />

    <!-- Input for file selection -->
    <input type="file" id="fileInput" accept=".jpg, .jpeg" />
    <button id="uploadButton">Upload Image</button>

    <script>
      fetch(
        "https://c9fuffy6cg.execute-api.eu-north-1.amazonaws.com/prod/recipe-bucket-anna?ID=test.jpg",
        {
          method: "GET",
        }
      )
        .then((response) => {
          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          return response.json(); //
        })
        .then((data) => {
          // Use the base64 string from the response
          const imageElement = document.getElementById("apiImage");
          imageElement.src = "data:image/jpeg;base64," + data.image; // Assuming 'image' is the key in the JSON response
        })
        .catch((error) => console.error("Error fetching image:", error));

      function uploadImage(file, recipeID) {
        // Create a new FormData object
        let formData = new FormData();

        // Append the file to the FormData object. The 'file' field name should match what your backend expects
        formData.append("file", file);

        // Optionally append additional data, like the recipeID
        formData.append("recipeID", recipeID);

        // Make the fetch call using FormData
        fetch(
          `https://c9fuffy6cg.execute-api.eu-north-1.amazonaws.com/prod/recipe-bucket-anna`,
          {
            method: "POST",
            body: formData, // Send the FormData object
          }
        )
          .then((response) => {
            if (!response.ok) {
              throw new Error("Network response was not ok");
            }
            return response.text();
          })
          .then((data) => {
            console.log("Image upload successful:", data);
          })
          .catch((error) => console.error("Error uploading image:", error));
      }

      // Event listener for the upload button
      document
        .getElementById("uploadButton")
        .addEventListener("click", function () {
          const fileInput = document.getElementById("fileInput");
          if (fileInput.files.length > 0) {
            const file = fileInput.files[0];
            uploadImage(file, "test"); // Call the function to upload the image
          } else {
            alert("Please select an image file to upload.");
          }
        });
    </script>
  </body>
</html>
